(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20d3293b"],{2167:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",{attrs:{wrap:"nowrap",justifyContent:"space-between"}},[r("flex-item",{attrs:{grow:1,width:"100%"}},[r("el-card",[r("flex-container",{attrs:{slot:"header",justifyContent:"space-between"},slot:"header"},[r("flex-item",{attrs:{alignItems:"center"}},[r("i",{staticClass:"el-icon-user margin-right-6 font-size-16"}),e._v("角色管理\n        ")]),r("flex-item",{attrs:{alignItems:"center"}},[r("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-plus",title:"添加"},on:{click:e.handleAddRole}}),r("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-search",title:"查询"},on:{click:e.handleQueryRole}}),r("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-refresh-left",title:"重置"},on:{click:function(t){return e.$refs["roleForm"].resetFields()}}})],1)],1),r("flex-container",{attrs:{direction:"column",wrap:"nowrap"}},[r("flex-item",{staticClass:"margin-bottom-10"},[r("el-form",{ref:"roleForm",staticClass:"form-style-line",attrs:{model:e.roleForm,"label-position":"right","label-width":"90px"}},[r("el-row",[r("col-pr",[r("el-form-item",{attrs:{label:"隶属组织 :",prop:"orgUuid"}},[r("el-cascader",{attrs:{options:e.orgTree,props:e.orgTreeProps,clearable:""},model:{value:e.roleForm.orgUuid,callback:function(t){e.$set(e.roleForm,"orgUuid",t)},expression:"roleForm.orgUuid"}})],1)],1),r("col-pr",[r("el-form-item",{attrs:{label:"角色编码 :",prop:"roleCode"}},[r("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.roleForm.roleCode,callback:function(t){e.$set(e.roleForm,"roleCode",t)},expression:"roleForm.roleCode"}})],1)],1),r("col-pr",[r("el-form-item",{attrs:{label:"角色名称 :",prop:"roleName"}},[r("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1)],1)],1)],1)],1),r("flex-item",[r("data-table",{ref:"roleTable",attrs:{border:"",index:"","auto-load":"","highlight-current-row":"","auto-update":"","column-button":"","csv-button":"",title:"Data Table","load-data-func":e.loadRole,pageOptions:e.pageOptions}},[r("data-table-column",{attrs:{prop:"roleName",label:"角色名称","show-overflow-tooltip":""}}),r("data-table-column",{attrs:{prop:"roleCode",label:"角色编码","show-overflow-tooltip":""}}),r("data-table-column",{attrs:{prop:"orgUuid",label:"隶属组织","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-cascader",{staticClass:"cascader-table-disabled",attrs:{options:e.orgTree,value:t.row.orgUuid,props:e.orgViewProps,disabled:""}})]}}])}),r("data-table-column",{attrs:{prop:"roleDesc",label:"角色描述","show-overflow-tooltip":""}}),r("data-table-column",{attrs:{prop:"op",label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(r){return e.handleEditRole(t.row)}}}),r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(r){return e.handleDelRole(t.row)}}})]}}])})],1)],1)],1)],1)],1),r("dialog-drag",{attrs:{title:"角色编辑",visible:e.showRoleDia,top:"8vh"},on:{"update:visible":function(t){e.showRoleDia=t}}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("i",{staticClass:"el-icon-edit margin-right-4"}),e._v("角色编辑\n    ")]),r("role-mgr-edit",{attrs:{initData:e.editRole},on:{updataData:e.doUpdataRole,close:function(t){e.showRoleDia=!1}}})],1)],1)},n=[],o=(r("456d"),r("ac6a"),r("f3e2"),r("96cf"),r("3b8d")),l=r("8070"),i=r("53ab"),s=r("bc30"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("el-form",{ref:"editForm",staticClass:"form-style-line",attrs:{model:e.formData,rules:e.formRules,"label-position":"right","label-width":"90px"}},[r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"角色名称 :",prop:"roleName"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"角色编码 :",prop:"roleCode"}},[r("el-input",{attrs:{maxlength:"10","show-word-limit":""},model:{value:e.formData.roleCode,callback:function(t){e.$set(e.formData,"roleCode",t)},expression:"formData.roleCode"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"隶属组织 :",prop:"orgUuid"}},[r("el-cascader",{attrs:{options:e.orgTree,props:e.orgTreeProps,clearable:""},model:{value:e.formData.orgUuid,callback:function(t){e.$set(e.formData,"orgUuid",t)},expression:"formData.orgUuid"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"角色描述 :",prop:"roleDesc"}},[r("el-input",{attrs:{type:"textarea",maxlength:"512","show-word-limit":""},model:{value:e.formData.roleDesc,callback:function(t){e.$set(e.formData,"roleDesc",t)},expression:"formData.roleDesc"}})],1)],1),e.formData.createdUser?[r("el-col",[r("el-form-item",{attrs:{label:"创建用户 :",prop:"createdUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.createdUser,callback:function(t){e.$set(e.formData,"createdUser",t)},expression:"formData.createdUser"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"创建时间 :",prop:"createdTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.createdTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"更新用户 :",prop:"updatedUser"}},[r("el-input",{attrs:{disabled:""},model:{value:e.formData.updatedUser,callback:function(t){e.$set(e.formData,"updatedUser",t)},expression:"formData.updatedUser"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"更新时间 :",prop:"updatedTime"}},[r("el-input",{attrs:{value:e.$utils.toDateString(e.formData.updatedTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1)]:e._e()],2)],1),r("flex-container",{staticClass:"padding-10"},[r("flex-item",{attrs:{width:"100%"}},[r("el-tabs",e._l(e.permMap,function(t){return r("el-tab-pane",{key:t.key,attrs:{label:t.label}},["1"===t.key?r("role-menu",{attrs:{data:t.data,checkedKeys:e.checkedKeys},model:{value:e.selectedMenu,callback:function(t){e.selectedMenu=t},expression:"selectedMenu"}}):e._e()],1)}),1)],1)],1),r("flex-container",{staticClass:"footer",attrs:{justifyContent:"flex-end"}},[r("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdateData}},[e._v("确 定")])],1)],1)},u=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("flex-container",{attrs:{direction:"column",wrap:"nowrap"}},[r("flex-container",[r("flex-item",{attrs:{grow:1}},[r("el-form",{staticClass:"form-style-line"},[r("el-form-item",[r("el-input",{attrs:{placeholder:"输入菜单名称或路径进行过滤",maxlength:"10","show-word-limit":""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)],1)],1),r("flex-item",{attrs:{alignItems:"center"}},[r("el-button",{attrs:{type:"pinforimary",size:"mini",plain:"",icon:e.isTreeExpand?"icon-ali ali-tuceng":"icon-ali ali-tuceng1",title:e.isTreeExpand?"全部折叠":"全部展开"},on:{click:e.handleExpandSwitch}})],1)],1),r("flex-item",[r("el-tree",{ref:"menuTree",attrs:{"show-checkbox":"",data:e.data,"default-checked-keys":e.checkedKeys,"node-key":e.menuTreeProps.key,props:e.menuTreeProps,"default-expand-all":"",draggable:"","render-content":e.doRenderTreeContent,"filter-node-method":e.doFilterNode},on:{"check-change":e.doCheckChange}})],1)],1)},m=[],p=(r("6762"),r("2fdb"),r("d25f"),{props:{data:{type:Array,default:function(){return[]}},value:{type:Array,default:function(){return[]}},checkedKeys:{type:Array,default:function(){return[]}}},data:function(){return{filterText:"",isTreeExpand:!0,menuTreeProps:{children:"children",label:"menuName",key:"uuid",disabled:function(e){return"1"!==e.menuVisible}}}},watch:{checkedKeys:{handler:function(e){this.$emit("input",e)},immediate:!0},filterText:function(e){this.$refs["menuTree"].filter(e)}},methods:{handleExpandSwitch:function(){this.isTreeExpand=!this.isTreeExpand,this.$utils.treeExpandSwitch(this.$refs["menuTree"],this.isTreeExpand)},doCheckChange:function(){this.$emit("input",this.$refs["menuTree"].getCheckedKeys())},doFilterNode:function(e,t){var r=t.menuName.includes(e),a=t.menuUrl.includes(e);return r||a},doRenderTreeContent:function(e,t){var r=t.node,a=t.data,n=(t.store,a.menuIcon+(1==a.menuVisible?" icon-color-success":" icon-color-info"));return e("flex-container",{attrs:{wrap:"nowrap",alignItems:"center",justifyContent:"space-between"}},[e("flex-item",{attrs:{alignItems:"center"}},[e("span",{class:"margin-right-2"},[e("i",{class:n})]),e("el-tooltip",{attrs:{content:a.menuUrl,placement:"right",effect:1==a.menuOpenWay?"dark":"light"}},[e("span",{class:"icon-size-14"},[r.label])])])])}}}),f=p,h=r("2877"),g=Object(h["a"])(f,d,m,!1,null,null,null),b=g.exports,y={components:{RoleMenu:b},props:{initData:{type:Object}},inject:["orgTree","orgTreeProps","permMap"],data:function(){return{loading:!1,selectedMenu:[],checkedKeys:[],formData:Object.assign({},this.initData),formRules:{roleName:[{required:!0,message:"请输入角色名称 !",trigger:"change"}],roleCode:[{required:!0,message:"请输入角色编码 !",trigger:"change"}],orgUuid:[{required:!0,message:"请选择隶属组织 !",trigger:"change"}]}}},mounted:function(){this.initData.uuid&&this.initPermSelect(this.initData.uuid)},methods:{initPermSelect:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,l["a"].getSelectPerm({roleUuid:t});case 4:r=e.sent,Object.keys(r.data).forEach(function(e){"1"===e&&(a.checkedKeys=r.data[e])}),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}},e,this,[[0,8,10,13]])}));function t(t){return e.apply(this,arguments)}return t}(),handleUpdateData:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs["editForm"].validate();case 3:this.formData.permUuids={1:this.selectedMenu},this.$emit("updataData",this.formData),this.$emit("close"),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}()}},w=y,x=Object(h["a"])(w,c,u,!1,null,null,null),v=x.exports,k={uuid:null,orgUuid:"",roleCode:"",roleName:"",roleDesc:"",createdUser:"",createdTime:"",updatedUser:"",updatedTime:"",permUuids:null},R={components:{RoleMgrEdit:v},provide:function(){return{orgTree:this.orgTree,orgTreeProps:this.orgTreeProps,permMap:this.permMap}},data:function(){return{permMap:[],orgTree:[],orgTreeProps:{checkStrictly:!0,emitPath:!1,value:"uuid",label:"orgName"},orgViewProps:{checkStrictly:!0,emitPath:!1,value:"uuid",label:"orgName"},showRoleDia:!1,roleForm:{orgUuid:"",roleCode:"",roleName:""},pageOptions:{pagerCount:5},editRole:{}}},mounted:function(){this.initOrgTree(),this.initPermMap()},methods:{initPermMap:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].getPermMap();case 2:t=e.sent,this.$utils.clear(this.permMap),Object.keys(t.data).forEach(function(e){var a;"1"===e&&(a=r.$utils.toArrayTree(t.data[e],{key:"menuUrl",parentKey:"menuParent",children:"children",sortKey:"menuOrde"})),r.permMap.push({key:e,label:"菜单资源",data:a})});case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),initOrgTree:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].getOrgTree();case 3:t=e.sent,this.$utils.eachTree(t.data,function(e){0===e.children.length&&delete e.children}),this.$utils.clear(this.orgTree),t.data.forEach(function(e){return r.orgTree.push(e)}),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}(),loadRole:function(e){return l["a"].querySysRole(e)},handleQueryRole:function(){this.$refs["roleTable"].loadData(this.roleForm)},handleEditRole:function(e){this.editRole=Object.assign({},e),this.showRoleDia=!0},handleAddRole:function(){this.editRole=Object.assign({},k),this.showRoleDia=!0},handleDelRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].delSysRole([t.uuid]);case 3:return e.prev=3,this.handleQueryRole(),e.finish(3);case 6:case"end":return e.stop()}},e,this,[[0,,3,6]])}));function t(t){return e.apply(this,arguments)}return t}(),doUpdataRole:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].saveSysRole(t);case 3:return e.prev=3,this.handleQueryRole(),e.finish(3);case 6:case"end":return e.stop()}},e,this,[[0,,3,6]])}));function t(t){return e.apply(this,arguments)}return t}()}},D=R,T=Object(h["a"])(D,a,n,!1,null,null,null);t["default"]=T.exports},"53ab":function(e,t,r){"use strict";var a=r("e716");t["a"]={saveSysOrg:function(e){return a["a"].post("/usrm/orgMgr/saveSysOrg",e)},getSysOrg:function(){return a["a"].get("/usrm/orgMgr/getSysOrg")},delSysOrg:function(e){return a["a"].delete("/usrm/orgMgr/delSysOrg/"+e)},getOrgTree:function(){return a["a"].get("/usrm/orgMgr/getOrgTree")}}},8070:function(e,t,r){"use strict";var a=r("e716");t["a"]={saveSysRole:function(e){return a["a"].post("/usrm/roleMgr/saveSysRole",e)},querySysRole:function(e){return a["a"].get("/usrm/roleMgr/querySysRole",{params:e})},delSysRole:function(e){return a["a"].delete("/usrm/roleMgr/delSysRole/"+e)},getSelectPerm:function(e){return a["a"].get("/usrm/roleMgr/getSelectPerm",{params:e})},getRoleByOrgUuid:function(e){return a["a"].get("/usrm/roleMgr/getRoleByOrgUuid",{params:e})}}},bc30:function(e,t,r){"use strict";var a=r("e716");t["a"]={saveSysPerm:function(e){return a["a"].post("/usrm/permMgr/saveSysPerm",e)},querySysPerm:function(e){return a["a"].get("/usrm/permMgr/querySysPerm",{params:e})},delSysPerm:function(e){return a["a"].delete("/usrm/permMgr/delSysPerm/"+e)},getPermMap:function(){return a["a"].get("/usrm/permMgr/getPermMap")}}}}]);
//# sourceMappingURL=chunk-20d3293b.d0f68799.js.map