(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e66b2"],{9951:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("flex-container",[a("flex-item",{attrs:{grow:1,width:"100%"}},[a("el-card",[a("flex-container",{attrs:{slot:"header",justifyContent:"space-between"},slot:"header"},[a("flex-item",{attrs:{alignItems:"center"}},[a("i",{staticClass:"el-icon-alarm-clock margin-right-6 font-size-16"}),t._v("任务管理\n        ")]),a("flex-item",{attrs:{alignItems:"center"}},[a("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-plus",title:"添加"},on:{click:t.handleAddQuartz}}),a("el-button",{attrs:{type:"primary",size:"mini",circle:"",icon:"el-icon-search",title:"查询"},on:{click:t.handleQueryQuartz}}),a("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-refresh-left",title:"重置"},on:{click:function(e){return t.$refs["quartzForm"].resetFields()}}}),a("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-video-play",disabled:!t.tableMultipleSelection.length>0,title:"批量启用"},on:{click:t.handleResumeJobs}}),a("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-video-pause",disabled:!t.tableMultipleSelection.length>0,title:"批量暂停"},on:{click:t.handlePauseJobs}}),a("el-button",{attrs:{size:"mini",circle:"",plain:"",icon:"el-icon-delete",disabled:!t.tableMultipleSelection.length>0,title:"批量删除"},on:{click:t.handleDelJobs}})],1)],1),a("flex-container",{attrs:{direction:"column",wrap:"nowrap"}},[a("flex-item",{staticClass:"margin-bottom-10"},[a("el-form",{ref:"quartzForm",staticClass:"form-style-line",attrs:{model:t.quartzForm,"label-position":"right","label-width":"80px"}},[a("el-row",[a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"任务名称",prop:"quartzName"}},[a("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:t.quartzForm.quartzName,callback:function(e){t.$set(t.quartzForm,"quartzName",e)},expression:"quartzForm.quartzName"}})],1)],1),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"任务组",prop:"quartzGroup"}},[a("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:t.quartzForm.quartzGroup,callback:function(e){t.$set(t.quartzForm,"quartzGroup",e)},expression:"quartzForm.quartzGroup"}})],1)],1),a("col-pr",{attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[a("el-form-item",{attrs:{label:"执行状态",prop:"quartzStat"}},[a("dict-select",{attrs:{"dict-key":"QuartzRunStat",placeholder:"请选择",clearable:""},model:{value:t.quartzForm.quartzStat,callback:function(e){t.$set(t.quartzForm,"quartzStat",e)},expression:"quartzForm.quartzStat"}})],1)],1)],1)],1)],1),a("flex-item",[a("data-table",{ref:"quartzTable",attrs:{border:"",index:"","auto-load":"","highlight-current-row":"","auto-update":"","column-button":"","csv-button":"",title:"Data Table","load-data-func":t.loadQuartz},on:{"selection-change":t.handleSelectionChange}},[a("data-table-column",{attrs:{prop:"selection",type:"selection",align:"center",width:"50",fixed:"left"}}),a("data-table-column",{attrs:{prop:"quartzName",label:"任务名称","show-overflow-tooltip":""}}),a("data-table-column",{attrs:{prop:"quartzGroup",label:"任务组","show-overflow-tooltip":""}}),a("data-table-column",{attrs:{prop:"quartzStat",label:"执行状态","show-overflow-tooltip":"",formatter:function(e){return t.$utils.tableColDictFormt("QuartzRunStat",e.quartzStat)}}}),a("data-table-column",{attrs:{prop:"quartzClass",label:"执行类路径","show-overflow-tooltip":""}}),a("data-table-column",{attrs:{prop:"quartzCron",label:"Cron表达式",width:"90",align:"center"}}),a("data-table-column",{attrs:{prop:"quartzDesc",label:"任务描述","show-overflow-tooltip":""}}),a("data-table-column",{attrs:{prop:"op",label:"操作",fixed:"right",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",disabled:"1"===e.row.quartzStat,icon:"el-icon-edit",title:"编辑"},on:{click:function(a){return t.handleEditQuartz(e.row)}}}),a("el-button",{attrs:{type:"text",disabled:"1"===e.row.quartzStat,icon:"el-icon-delete",title:"删除"},on:{click:function(a){return t.handleDelJob(e.row)}}}),a("el-button",{attrs:{type:"text",disabled:"1"===e.row.quartzStat,icon:"el-icon-video-play",title:"启用"},on:{click:function(a){return t.handleResumeJob(e.row)}}}),a("el-button",{attrs:{type:"text",disabled:"2"===e.row.quartzStat,icon:"el-icon-video-pause",title:"暂停"},on:{click:function(a){return t.handlePauseJob(e.row)}}}),a("el-button",{attrs:{type:"text",icon:"el-icon-more",title:"详情"},on:{click:function(a){return t.handleViewJob(e.row)}}})]}}])})],1)],1)],1)],1)],1),a("dialog-drag",{attrs:{visible:t.showQuartzDia,top:"8vh"},on:{"update:visible":function(e){t.showQuartzDia=e}}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-icon-edit margin-right-4"}),t._v(t._s(t.quartzEditReadonly?"任务详情":"任务编辑")+"\n    ")]),a("quartz-mgr-edit",{attrs:{readonly:t.quartzEditReadonly,initData:t.editQuartz},on:{updataData:t.doUpdataQuartz,close:function(e){t.showQuartzDia=!1}}})],1)],1)},n=[],l=(a("ac6a"),a("f3e2"),a("96cf"),a("3b8d")),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("flex-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"elemeur-loading-text":"正在读取数据..."}},[a("el-form",{ref:"editForm",staticClass:"form-style-line",attrs:{model:t.formData,rules:t.formRules,"label-position":"right","label-width":"100px"}},[a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"任务名称",prop:"quartzName"}},[a("el-input",{attrs:{maxlength:"40","show-word-limit":"",disabled:t.readonly},model:{value:t.formData.quartzName,callback:function(e){t.$set(t.formData,"quartzName",e)},expression:"formData.quartzName"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"任务组",prop:"quartzGroup"}},[a("el-input",{attrs:{maxlength:"40","show-word-limit":"",disabled:t.readonly},model:{value:t.formData.quartzGroup,callback:function(e){t.$set(t.formData,"quartzGroup",e)},expression:"formData.quartzGroup"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"执行类",prop:"quartzClass"}},[a("el-select",{attrs:{disabled:t.readonly},model:{value:t.formData.quartzClass,callback:function(e){t.$set(t.formData,"quartzClass",e)},expression:"formData.quartzClass"}},t._l(t.jobClass,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})}),1)],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"Cron表达式",prop:"quartzCron"}},[a("cron-tab",{attrs:{disabled:t.readonly},model:{value:t.formData.quartzCron,callback:function(e){t.$set(t.formData,"quartzCron",e)},expression:"formData.quartzCron"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"初始参数",prop:"quartzParams"}},[a("el-input",{attrs:{maxlength:"20","show-word-limit":"",disabled:t.readonly},model:{value:t.formData.quartzParams,callback:function(e){t.$set(t.formData,"quartzParams",e)},expression:"formData.quartzParams"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"执行策略",prop:"quartzMisfire"}},[a("dict-select",{attrs:{"dict-key":"QuartzMisfire",placeholder:"请选择",clearable:"",disabled:t.readonly},model:{value:t.formData.quartzMisfire,callback:function(e){t.$set(t.formData,"quartzMisfire",e)},expression:"formData.quartzMisfire"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"优先级",prop:"quartzPriority"}},[a("el-input",{attrs:{maxlength:"2","show-word-limit":"",disabled:t.readonly},model:{value:t.formData.quartzPriority,callback:function(e){t.$set(t.formData,"quartzPriority",t._n(e))},expression:"formData.quartzPriority"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"任务描述",prop:"quartzDesc"}},[a("el-input",{attrs:{type:"textarea",maxlength:"512","show-word-limit":"",disabled:t.readonly},model:{value:t.formData.quartzDesc,callback:function(e){t.$set(t.formData,"quartzDesc",e)},expression:"formData.quartzDesc"}})],1)],1),t.readonly?t._e():a("el-col",[a("el-form-item",{attrs:{label:"立即执行",prop:"isRun"}},[a("el-radio-group",{attrs:{disabled:t.readonly},model:{value:t.formData.isRun,callback:function(e){t.$set(t.formData,"isRun",e)},expression:"formData.isRun"}},[a("el-radio",{attrs:{label:!0}},[t._v("是")]),a("el-radio",{attrs:{label:!1}},[t._v("否")])],1)],1)],1),t.formData.quartzExce?a("el-col",[a("el-form-item",{attrs:{label:"异常信息",prop:"quartzExce"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:6},readonly:"",value:t.formData.quartzExce}})],1)],1):t._e(),null!==t.quartzJob?[a("el-col",[a("el-form-item",{attrs:{label:"下次执行",prop:"nextFireTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.quartzJob.nextFireTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"上次执行",prop:"prevFireTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.quartzJob.prevFireTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"生效时间",prop:"startTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.quartzJob.startTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"失效时间",prop:"endTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.quartzJob.endTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1)]:t._e(),t.formData.createdUser?[a("el-col",[a("el-form-item",{attrs:{label:"创建用户 :",prop:"createdUser"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.createdUser,callback:function(e){t.$set(t.formData,"createdUser",e)},expression:"formData.createdUser"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"创建时间 :",prop:"createdTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.formData.createdTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"更新用户 :",prop:"updatedUser"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.updatedUser,callback:function(e){t.$set(t.formData,"updatedUser",e)},expression:"formData.updatedUser"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"更新时间 :",prop:"updatedTime"}},[a("el-input",{attrs:{value:t.$utils.toDateString(t.formData.updatedTime,"yyyy-MM-dd HH:mm:ss"),disabled:""}})],1)],1)]:t._e()],2)],1),a("flex-container",{staticClass:"footer",attrs:{justifyContent:"flex-end"}},[a("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleUpdateData}},[t._v("确 定")])],1)],1)},o=[],s=a("e716"),u={querySysQuartz:function(t){return s["a"].get("/sysm/quartzMgr/querySysQuartz",{params:t})},getJobClass:function(){return s["a"].get("/sysm/quartzMgr/getJobClass")},saveSysQuartz:function(t){return s["a"].post("/sysm/quartzMgr/saveSysQuartz",t)},delSysQuartz:function(t){return s["a"].delete("/sysm/quartzMgr/delSysQuartz/"+t)},resumeSysQuartz:function(t){return s["a"].put("/sysm/quartzMgr/resumeSysQuartz/"+t)},pauseSysQuartz:function(t){return s["a"].put("/sysm/quartzMgr/pauseSysQuartz/"+t)},getSysQuartzJobInfo:function(t){return s["a"].get("/sysm/quartzMgr/getSysQuartzJobInfo",{params:t})}},c={props:{initData:{type:Object},readonly:{type:Boolean,default:!1}},inject:["jobClass"],data:function(){return{loading:!1,formData:Object.assign({},this.initData),quartzJob:null,formRules:{quartzName:[{required:!0,message:"请输入任务名称",trigger:"change"}],quartzGroup:[{required:!0,message:"请输入任务组",trigger:"change"}],quartzClass:[{required:!0,message:"请选择执行类",trigger:"change"}],quartzCron:[{required:!0,message:"请输入Cron表达式",trigger:"change"}],quartzPriority:[{type:"number",message:"请输入数值",trigger:"change"}]}}},mounted:function(){this.formData.uuid&&this.getQuartzJobInfo()},methods:{getQuartzJobInfo:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.getSysQuartzJobInfo({uuid:this.formData.uuid});case 2:e=t.sent,this.quartzJob=e.data;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),handleUpdateData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["editForm"].validate();case 3:this.$emit("updataData",this.formData),this.$emit("close"),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}()}},d=c,m=a("2877"),p=Object(m["a"])(d,i,o,!1,null,null,null),f=p.exports,h={uuid:null,quartzName:"",quartzGroup:"",quartzStat:"",quartzClass:"",quartzCron:"",quartzExce:"",quartzDesc:"",quartzParams:"",quartzMisfire:"1",quartzPriority:0,isRun:!1,createdUser:"",createdTime:"",updatedUser:"",updatedTime:""},b={components:{QuartzMgrEdit:f},provide:function(){return{jobClass:this.jobClass}},data:function(){return{quartzEditReadonly:!1,showQuartzDia:!1,quartzForm:{quartzName:null,quartzGroup:null,quartzStat:null},tableMultipleSelection:[],editQuartz:{},jobClass:[]}},mounted:function(){this.loadJobClass()},methods:{loadJobClass:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.getJobClass();case 3:e=t.sent,this.$utils.clear(this.jobClass),e.data.forEach(function(t){return a.jobClass.push(t)}),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:case"end":return t.stop()}},t,this,[[0,8]])}));function e(){return t.apply(this,arguments)}return e}(),loadQuartz:function(t){return u.querySysQuartz(t)},handleQueryQuartz:function(){this.$refs["quartzTable"].loadData(this.quartzForm)},handleAddQuartz:function(){this.editQuartz=Object.assign({},h),this.quartzEditReadonly=!1,this.showQuartzDia=!0},handleEditQuartz:function(t){this.editQuartz=Object.assign({},h,t),this.quartzEditReadonly=!1,this.showQuartzDia=!0},handleViewJob:function(t){this.editQuartz=Object.assign({},h,t),this.quartzEditReadonly=!0,this.showQuartzDia=!0},handleSelectionChange:function(t){var e=[];t.forEach(function(t){e.push(t.uuid)}),this.tableMultipleSelection=e},handleResumeJob:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.resumeSysQuartz([e.uuid]);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t["catch"](0);case 7:return t.prev=7,this.handleQueryQuartz(),t.finish(7);case 10:case"end":return t.stop()}},t,this,[[0,5,7,10]])}));function e(e){return t.apply(this,arguments)}return e}(),handleResumeJobs:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(this.tableMultipleSelection.length>0)){t.next=4;break}return t.next=4,u.resumeSysQuartz(this.tableMultipleSelection);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t["catch"](0);case 8:return t.prev=8,this.handleQueryQuartz(),t.finish(8);case 11:case"end":return t.stop()}},t,this,[[0,6,8,11]])}));function e(){return t.apply(this,arguments)}return e}(),handlePauseJob:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.pauseSysQuartz([e.uuid]);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t["catch"](0);case 7:return t.prev=7,this.handleQueryQuartz(),t.finish(7);case 10:case"end":return t.stop()}},t,this,[[0,5,7,10]])}));function e(e){return t.apply(this,arguments)}return e}(),handlePauseJobs:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(this.tableMultipleSelection.length>0)){t.next=4;break}return t.next=4,u.pauseSysQuartz(this.tableMultipleSelection);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t["catch"](0);case 8:return t.prev=8,this.handleQueryQuartz(),t.finish(8);case 11:case"end":return t.stop()}},t,this,[[0,6,8,11]])}));function e(){return t.apply(this,arguments)}return e}(),handleDelJob:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.delSysQuartz([e.uuid]);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:return t.prev=8,this.handleQueryQuartz(),t.finish(8);case 11:case"end":return t.stop()}},t,this,[[0,5,8,11]])}));function e(e){return t.apply(this,arguments)}return e}(),handleDelJobs:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(this.tableMultipleSelection.length>0)){t.next=4;break}return t.next=4,u.delSysQuartz(this.tableMultipleSelection);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t["catch"](0);case 8:return t.prev=8,this.handleQueryQuartz(),t.finish(8);case 11:case"end":return t.stop()}},t,this,[[0,6,8,11]])}));function e(){return t.apply(this,arguments)}return e}(),doUpdataQuartz:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.saveSysQuartz(e);case 3:return t.prev=3,this.handleQueryQuartz(),t.finish(3);case 6:case"end":return t.stop()}},t,this,[[0,,3,6]])}));function e(e){return t.apply(this,arguments)}return e}()}},z=b,y=Object(m["a"])(z,r,n,!1,null,null,null);e["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2d0e66b2.4069ec29.js.map